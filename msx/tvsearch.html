<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>TV Duck Search</title>
<style>
body{
    background:#111;
    color:white;
    font-family:Arial;
    text-align:center;
}
#query{
    font-size:26px;
    margin:20px;
    min-height:40px;
    border:2px solid #444;
    padding:10px;
}
.key{
    display:inline-block;
    width:60px;
    margin:4px;
    padding:14px;
    background:#222;
    border:3px solid #444;
    font-size:18px;
}
.focused{
    border:3px solid red !important;
    background:#333 !important;
}
</style>
</head>
<body>

<h2>TV Duck Search</h2>

<div id="query"></div>
<div id="keyboard"></div>
<div class="key" id="searchBtn" style="width:200px;">SEARCH</div>

<script>

var query="";
var index=0;
var elements=[];
var keys="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
var keyboard=document.getElementById("keyboard");

for(var i=0;i<keys.length;i++){
    var k=document.createElement("div");
    k.className="key";
    k.innerHTML=keys[i];
    k.onclick=(function(letter){
        return function(){
            query+=letter;
            updateQuery();
        }
    })(keys[i]);
    keyboard.appendChild(k);
}

var space=document.createElement("div");
space.className="key";
space.innerHTML="_";
space.onclick=function(){ query+=" "; updateQuery(); };
keyboard.appendChild(space);

var back=document.createElement("div");
back.className="key";
back.innerHTML="â†";
back.onclick=function(){ query=query.slice(0,-1); updateQuery(); };
keyboard.appendChild(back);

function updateQuery(){
    document.getElementById("query").innerHTML=query;
}

function rebuildElements(){
    elements=[];
    var all=document.getElementsByClassName("key");
    for(var i=0;i<all.length;i++) elements.push(all[i]);
    index=0;
    updateFocus();
}

function updateFocus(){
    for(var i=0;i<elements.length;i++){
        elements[i].className=elements[i].className.replace(" focused","");
    }
    if(elements[index]){
        elements[index].className+=" focused";
    }
}

document.onkeydown=function(e){
    var code=e.keyCode||e.which;

    var UP=38,DOWN=40,LEFT=37,RIGHT=39,ENTER=13;
    var TV_UP=29460,TV_DOWN=29461,TV_ENTER=29443;

    if(code==RIGHT){ index++; if(index>=elements.length) index=0; updateFocus(); return false; }
    if(code==LEFT){ index--; if(index<0) index=elements.length-1; updateFocus(); return false; }
    if(code==DOWN||code==TV_DOWN){ index+=6; if(index>=elements.length) index=elements.length-1; updateFocus(); return false; }
    if(code==UP||code==TV_UP){ index-=6; if(index<0) index=0; updateFocus(); return false; }

    if(code==ENTER||code==TV_ENTER){
        if(elements[index] && elements[index].onclick) elements[index].onclick();
        return false;
    }
};

document.getElementById("searchBtn").onclick=function(){

    if(query.length==0) return;

    document.body.innerHTML = `
    <style>
    body{margin:0;background:black}
    #frame{width:100%;height:100%;border:0}
    #cursor{
        position:fixed;
        left:0;
        top:0;
        width:100%;
        height:60px;
        border:4px solid red;
        pointer-events:none;
        z-index:9999;
    }
    </style>

    <div id="cursor"></div>
    <iframe id="frame"
        src="https://lite.duckduckgo.com/lite/?q=` + encodeURIComponent(query) + `">
    </iframe>
    `;

    var cursorY=0;
    var step=70;

    document.onkeydown=function(e){
        var code=e.keyCode||e.which;

        if(code==40){ // DOWN
            cursorY+=step;
            document.getElementById("cursor").style.top=cursorY+"px";
        }

        if(code==38){ // UP
            cursorY-=step;
            if(cursorY<0) cursorY=0;
            document.getElementById("cursor").style.top=cursorY+"px";
        }

        if(code==13){ // ENTER
            var frame=document.getElementById("frame").contentWindow;
            frame.scrollTo(0,cursorY);
        }
    };
};

rebuildElements();

</script>

</body>
</html>
